<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Theron: Theron::Actor::RegisterHandler</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.6.3 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<script type="text/javascript">
<!--
function changeDisplayState (e){
  var num=this.id.replace(/[^[0-9]/g,'');
  var button=this.firstChild;
  var sectionDiv=document.getElementById('dynsection'+num);
  if (sectionDiv.style.display=='none'||sectionDiv.style.display==''){
    sectionDiv.style.display='block';
    button.src='open.gif';
  }else{
    sectionDiv.style.display='none';
    button.src='closed.gif';
  }
}
function initDynSections(){
  var divs=document.getElementsByTagName('div');
  var sectionCounter=1;
  for(var i=0;i<divs.length-1;i++){
    if(divs[i].className=='dynheader'&&divs[i+1].className=='dynsection'){
      var header=divs[i];
      var section=divs[i+1];
      var button=header.firstChild;
      if (button!='IMG'){
        divs[i].insertBefore(document.createTextNode(' '),divs[i].firstChild);
        button=document.createElement('img');
        divs[i].insertBefore(button,divs[i].firstChild);
      }
      header.style.cursor='pointer';
      header.onclick=changeDisplayState;
      header.id='dynheader'+sectionCounter;
      button.src='closed.gif';
      section.id='dynsection'+sectionCounter;
      section.style.display='none';
      section.style.marginLeft='14px';
      sectionCounter++;
    }
  }
}
window.onload = initDynSections;
-->
</script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <img id="MSearchSelect" src="search/search.png"
             onmouseover="return searchBox.OnSearchSelectShow()"
             onmouseout="return searchBox.OnSearchSelectHide()"
             alt=""/>
        <input type="text" id="MSearchField" value="Search" accesskey="S"
             onfocus="searchBox.OnSearchFieldFocus(true)" 
             onblur="searchBox.OnSearchFieldFocus(false)" 
             onkeyup="searchBox.OnSearchFieldChange(event)"/>
        <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
        </div>
      </li>
    </ul>
  </div>
</div>
<div class="contents">
  <div class="navpath"><a class="el" href="namespaceTheron.html">Theron</a>::<a class="el" href="classTheron_1_1Actor.html">Actor</a>
  </div>
<table cellspacing="0" cellpadding="0" border="0">
  <tr>
   <td valign="top">
      <div class="navtab">
        <table>
          <tr><td class="navtab"><a class="qindex" href="classTheron_1_1Actor_ab382214464453ecbadd73ebbd2789645.html#ab382214464453ecbadd73ebbd2789645">Actor</a></td></tr>
          <tr><td class="navtab"><a class="qindex" href="classTheron_1_1Actor_a8f0fd920b4d270cf8c8184104b958092.html#a8f0fd920b4d270cf8c8184104b958092">DeregisterHandler</a></td></tr>
          <tr><td class="navtab"><a class="qindex" href="classTheron_1_1Actor_a41a42e5c507e83ec3b5f0806a8869715.html#a41a42e5c507e83ec3b5f0806a8869715">GetAddress</a></td></tr>
          <tr><td class="navtab"><a class="qindex" href="classTheron_1_1Actor_afe30f86e99ff80691ec11e207711a46a.html#afe30f86e99ff80691ec11e207711a46a">GetFramework</a></td></tr>
          <tr><td class="navtab"><a class="qindex" href="classTheron_1_1Actor_a4f6af5dba4b36bbb55ee216589ccfb63.html#a4f6af5dba4b36bbb55ee216589ccfb63">GetNumQueuedMessages</a></td></tr>
          <tr><td class="navtab"><a class="qindex" href="classTheron_1_1Actor_a6bfdf3ec59943e2c8f1e686d2e3c1077.html#a6bfdf3ec59943e2c8f1e686d2e3c1077">IsHandlerRegistered</a></td></tr>
          <tr><td class="navtab"><a class="qindexHL" href="classTheron_1_1Actor_a6a5a4bd492f490bf730274c247b584da.html#a6a5a4bd492f490bf730274c247b584da">RegisterHandler</a></td></tr>
          <tr><td class="navtab"><a class="qindex" href="classTheron_1_1Actor_afc5ae7842ea425c13440363bcb4ae1f2.html#afc5ae7842ea425c13440363bcb4ae1f2">Send</a></td></tr>
          <tr><td class="navtab"><a class="qindex" href="classTheron_1_1Actor_a9d2a84c501b187c0b531ac9f5a30e2c9.html#a9d2a84c501b187c0b531ac9f5a30e2c9">SetDefaultHandler</a></td></tr>
          <tr><td class="navtab"><a class="qindex" href="classTheron_1_1Actor_acefedebe52fe74026c65cfab5a209a11.html#acefedebe52fe74026c65cfab5a209a11">SetDefaultHandler</a></td></tr>
          <tr><td class="navtab"><a class="qindex" href="classTheron_1_1Actor_af566742b7486c810cc694897adcbe958.html#af566742b7486c810cc694897adcbe958">TailSend</a></td></tr>
          <tr><td class="navtab"><a class="qindex" href="classTheron_1_1Actor_ab60796f45fdf65fbcc2f27abdeac37f9.html#ab60796f45fdf65fbcc2f27abdeac37f9">~Actor</a></td></tr>
        </table>
      </div>
   </td>
   <td valign="top">
<a class="anchor" id="a6a5a4bd492f490bf730274c247b584da"></a><!-- doxytag: member="Theron::Actor::RegisterHandler" ref="a6a5a4bd492f490bf730274c247b584da" args="(ActorType *const actor, void(ActorType::*handler)(const ValueType &amp;message, const Address from))" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class ActorType , class ValueType &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">bool Theron::Actor::RegisterHandler </td>
          <td>(</td>
          <td class="paramtype">ActorType *const&nbsp;</td>
          <td class="paramname"> <em>actor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void(ActorType::*)(const ValueType &amp;message, const <a class="el" href="classTheron_1_1Address.html">Address</a> from)&nbsp;</td>
          <td class="paramname"> <em>handler</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline, protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Registers a handler for a specific message type. </p>
<p>Derived actor classes should call this method to register message handlers. Once registered, a message handler is automatically executed whenever the owning actor receives a message of the type that the message handler function accepts.</p>
<p>For example this simple HelloWorld actor has a single handler which is executed in response to <em>hello</em> messages. It's important to note that message handlers must currently always take their message parameters by <em>reference:</em> </p>
<div class="fragment"><pre class="fragment">    <span class="keyword">class </span>HelloWorld : <span class="keyword">public</span> Theron::<a class="code" href="classTheron_1_1Actor_ab382214464453ecbadd73ebbd2789645.html#ab382214464453ecbadd73ebbd2789645" title="Default constructor.">Actor</a>
    {
    <span class="keyword">public</span>:

        <span class="keyword">struct </span>HelloMessage { };

        HelloWorld()
        {
            <a class="code" href="classTheron_1_1Actor_a6a5a4bd492f490bf730274c247b584da.html#a6a5a4bd492f490bf730274c247b584da" title="Registers a handler for a specific message type.">RegisterHandler</a>(<span class="keyword">this</span>, &amp;HelloWorld::Hello);
        }

    <span class="keyword">private</span>:

        <span class="keyword">inline</span> <span class="keywordtype">void</span> Hello(<span class="keyword">const</span> HelloMessage &amp;message, <span class="keyword">const</span> <a class="code" href="classTheron_1_1Address.html" title="The unique address of an entity that can send or receive messages.">Theron::Address</a> from)
        {
            printf(<span class="stringliteral">&quot;Hello world!\n&quot;</span>);
        }
    };
</pre></div><p>Message handlers can be registered at basically any point in the lifetime of the actor. In particular they can safely be registered in the derived actor constructor, as well as from within other message handlers of the actor (themselves previously registered and then executed in response to received messages).</p>
<p>If a message handler is registered multiple times, it will be executed multiple times in response to received messages of its expected type.</p>
<p>One subtlety to be aware of is that message handlers aren't executed on receipt of messages of types <em>derived</em> from the message types expected by the handler. In order to handle derived message types, register separate handlers for those types - and call the handler registered for the base message type explicitly from the derived handler, if required.</p>
<div class="fragment"><pre class="fragment">    <span class="keyword">class </span>HelloWorld : <span class="keyword">public</span> Theron::<a class="code" href="classTheron_1_1Actor_ab382214464453ecbadd73ebbd2789645.html#ab382214464453ecbadd73ebbd2789645" title="Default constructor.">Actor</a>
    {
    <span class="keyword">public</span>:

        <span class="keyword">struct </span>HelloMessage { };
        <span class="keyword">struct </span>HowdyMessage : <span class="keyword">public</span> HelloMessage { };

        HelloWorld()
        {
            <a class="code" href="classTheron_1_1Actor_a6a5a4bd492f490bf730274c247b584da.html#a6a5a4bd492f490bf730274c247b584da" title="Registers a handler for a specific message type.">RegisterHandler</a>(<span class="keyword">this</span>, &amp;HelloWorld::Hello);
            <a class="code" href="classTheron_1_1Actor_a6a5a4bd492f490bf730274c247b584da.html#a6a5a4bd492f490bf730274c247b584da" title="Registers a handler for a specific message type.">RegisterHandler</a>(<span class="keyword">this</span>, &amp;HelloWorld::Howdy);
        }

    <span class="keyword">private</span>:

        <span class="keyword">inline</span> <span class="keywordtype">void</span> Hello(<span class="keyword">const</span> HelloMessage &amp;message, <span class="keyword">const</span> <a class="code" href="classTheron_1_1Address.html" title="The unique address of an entity that can send or receive messages.">Theron::Address</a> from)
        {
            printf(<span class="stringliteral">&quot;Hello world!\n&quot;</span>);
        }

        <span class="keyword">inline</span> <span class="keywordtype">void</span> Howdy(<span class="keyword">const</span> HowdyMessage &amp;message, <span class="keyword">const</span> <a class="code" href="classTheron_1_1Address.html" title="The unique address of an entity that can send or receive messages.">Theron::Address</a> from)
        {
            Hello(message, from);
            printf(<span class="stringliteral">&quot;How y&#39;all doin?\n&quot;</span>);
        }
    };
</pre></div><p>Another tricky subtlety is that <em>identical</em> handlers are sometimes treated as the same function, by the compiler, in optimized builds. The following example shows this confusing effect:</p>
<div class="fragment"><pre class="fragment">    <span class="keyword">class </span>HelloWorld : <span class="keyword">public</span> Theron::<a class="code" href="classTheron_1_1Actor_ab382214464453ecbadd73ebbd2789645.html#ab382214464453ecbadd73ebbd2789645" title="Default constructor.">Actor</a>
    {
    <span class="keyword">public</span>:

        <span class="keyword">struct </span>HelloMessage { };

        HelloWorld()
        {
            <a class="code" href="classTheron_1_1Actor_a6a5a4bd492f490bf730274c247b584da.html#a6a5a4bd492f490bf730274c247b584da" title="Registers a handler for a specific message type.">RegisterHandler</a>(<span class="keyword">this</span>, &amp;HelloWorld::HelloOne);
            <a class="code" href="classTheron_1_1Actor_a6bfdf3ec59943e2c8f1e686d2e3c1077.html#a6bfdf3ec59943e2c8f1e686d2e3c1077" title="Checks whether the given message handler is registered with the actor.">IsHandlerRegistered</a>(<span class="keyword">this</span>, &amp;HelloWorld::HelloTwo);   <span class="comment">// Returns true, if some optimized builds.</span>
        }

    <span class="keyword">private</span>:

        <span class="keyword">inline</span> <span class="keywordtype">void</span> HelloOne(<span class="keyword">const</span> HelloMessage &amp;message, <span class="keyword">const</span> <a class="code" href="classTheron_1_1Address.html" title="The unique address of an entity that can send or receive messages.">Theron::Address</a> from)
        {
            printf(<span class="stringliteral">&quot;Hello world!\n&quot;</span>);
        }

        <span class="keyword">inline</span> <span class="keywordtype">void</span> HelloTwo(<span class="keyword">const</span> HelloMessage &amp;message, <span class="keyword">const</span> <a class="code" href="classTheron_1_1Address.html" title="The unique address of an entity that can send or receive messages.">Theron::Address</a> from)
        {
            printf(<span class="stringliteral">&quot;Hello world!\n&quot;</span>);
        }
    };
</pre></div><dl><dt><b>Template Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>ActorType</em>&nbsp;</td><td>The derived actor class. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ValueType</em>&nbsp;</td><td>The message type accepted by the handler. </td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>actor</em>&nbsp;</td><td>Pointer to the derived actor instance. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>handler</em>&nbsp;</td><td>Member function pointer identifying the message handler function. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>True, if the registration was successful. Failure may indicate out-of-memory.</dd></dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a href="http://www.theron-library.com/index.php?t=page&amp;p=HandlingMessages">Handling messages</a> </dd>
<dd>
<a href="http://www.theron-library.com/index.php?t=page&amp;p=DynamicHandlerRegistration">Dynamic handler registration</a> </dd></dl>

</div>
</div>
    </td>
  </tr>
</table>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&nbsp;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&nbsp;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&nbsp;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&nbsp;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address style="text-align: right;"><small>Generated by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.3 </small></address>
</body>
</html>
